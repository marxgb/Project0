{"paragraphs":[{"text":"%spark\r\nimport org.apache.spark.{SparkConf, SparkContext}\r\nimport org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql._\r\nimport org.apache.spark.sql.types.{StructType, StructField, StringType}\r\n\r\nval US_Senators_DF = spark.read.format(\"csv\").option(\"header\", true).load(\"/data/Project2Data_USSenators.csv\")\r\nval NY_Senator_DF = US_Senators_DF.filter(US_Senators_DF(\"state\") === \"NEW YORK\")\r\n\r\nval party = sc.parallelize(Seq(\"REPUBLICAN\", \"SOCIALIST WORKERS\", \"LIBERAL\", \"CONSERVATIVE\", \"LABOR\" ,\"\" +\r\n\"COMMUNIST\", \"LIBERTARIAN\", \"DEMOCRAT\", \"FREE LIBERTARIAN\", \"RIGHT TO LIFE\", \"NEW ALLIANCE\", \"WORKERS WORLD\", \"INDEPENDENT PROGRESSIVE LINE\", \"\" +\r\n\"NATURAL LAW\", \"INDEPENDENCE FUSION\", \"GREEN\", \"MARIJUANA REFORM\", \"CONSTITUTION\", \"INDEPENDENCE\", \"BUILDERS\", \"WORKING FAMILIES\", \"\" +\r\n\"SOCIALIST EQUALITY\", \"RENT IS 2 DAMN HIGH\", \"TAX REVOLT\", \"ANTI-PROHIBITION\", \"COMMON SENSE\", \"REFORM\", \"WOMEN'S EQUALITY\"))\r\n\r\nval party_DF = party.toDF(\"Party\")\r\nparty_DF.cache()\r\nval records = party_DF.join(NY_Senator_DF, col(\"party_detailed\") === col(\"Party\"))\r\nrecords.createOrReplaceTempView(\"records\")","user":"anonymous","dateUpdated":"2021-12-02T21:26:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types.{StructType, StructField, StringType}\nUS_Senators_DF: org.apache.spark.sql.DataFrame = [year: string, state: string ... 17 more fields]\nNY_Senator_DF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [year: string, state: string ... 17 more fields]\nparty: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[41] at parallelize at <console>:68\nparty_DF: org.apache.spark.sql.DataFrame = [Party: string]\nres5: party_DF.type = [Party: string]\nrecords: org.apache.spark.sql.DataFrame = [Party: string, year: string ... 18 more fields]\n"}]},"apps":[],"jobName":"paragraph_1637699333131_245044587","id":"20211123-202853_773728762","dateCreated":"2021-11-23T20:28:53+0000","dateStarted":"2021-12-02T21:26:03+0000","dateFinished":"2021-12-02T21:26:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:296","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"2GQMH89FZ"}}},{"text":"%spark.sql\nSELECT SUM(candidatevotes), Party FROM records GROUP BY Party ORDER BY SUM(candidatevotes) DESC","user":"anonymous","dateUpdated":"2021-11-23T20:34:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sum(CAST(candidatevotes AS DOUBLE))":"string","Party":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Party","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(CAST(candidatevotes AS DOUBLE))","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sum(CAST(candidatevotes AS DOUBLE))\tParty\n5.1926708E7\tDEMOCRAT\n2.9084059E7\tREPUBLICAN\n3834791.0\tCONSERVATIVE\n1592350.0\tLIBERAL\n1071985.0\tWORKING FAMILIES\n917346.0\tINDEPENDENCE\n905390.0\tRIGHT TO LIFE\n381822.0\tGREEN\n325854.0\tLIBERTARIAN\n112833.0\tSOCIALIST WORKERS\n87391.0\tWOMEN'S EQUALITY\n67190.0\tNEW ALLIANCE\n44844.0\tFREE LIBERTARIAN\n39423.0\tREFORM\n34281.0\tMARIJUANA REFORM\n29302.0\tCOMMUNIST\n26650.0\tINDEPENDENCE FUSION\n23747.0\tNATURAL LAW\n21985.0\tCOMMON SENSE\n17216.0\tWORKERS WORLD\n17019.0\tRENT IS 2 DAMN HIGH\n16196.0\tBUILDERS\n14770.0\tINDEPENDENT PROGRESSIVE LINE\n11787.0\tANTI-PROHIBITION\n6716.0\tLABOR\n6004.0\tSOCIALIST EQUALITY\n4516.0\tTAX REVOLT\n3414.0\tCONSTITUTION\n"}]},"apps":[],"jobName":"paragraph_1637699351806_1251728459","id":"20211123-202911_804167697","dateCreated":"2021-11-23T20:29:11+0000","dateStarted":"2021-11-23T20:31:16+0000","dateFinished":"2021-11-23T20:31:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"import spark.implicits._\r\n\r\nval US_Senators_DF = spark.read.format(\"csv\").option(\"header\", true).load(\"/data/Project2Data_USSenators.csv\")\r\nval NY_Senator_DF = US_Senators_DF.filter(US_Senators_DF(\"state\") === \"TEXAS\")\r\n\r\nval party = sc.parallelize(Seq(\"REPUBLICAN\", \"SOCIALIST WORKERS\", \"LIBERAL\", \"CONSERVATIVE\", \"LABOR\" ,\"\" +\r\n\"COMMUNIST\", \"LIBERTARIAN\", \"DEMOCRAT\", \"FREE LIBERTARIAN\", \"RIGHT TO LIFE\", \"NEW ALLIANCE\", \"WORKERS WORLD\", \"INDEPENDENT PROGRESSIVE LINE\", \"\" +\r\n\"NATURAL LAW\", \"INDEPENDENCE FUSION\", \"GREEN\", \"MARIJUANA REFORM\", \"CONSTITUTION\", \"INDEPENDENCE\", \"BUILDERS\", \"WORKING FAMILIES\", \"\" +\r\n\"SOCIALIST EQUALITY\", \"RENT IS 2 DAMN HIGH\", \"TAX REVOLT\", \"ANTI-PROHIBITION\", \"COMMON SENSE\", \"REFORM\", \"WOMEN'S EQUALITY\"))\r\n\r\nval party_DF = party.toDF(\"Party\")\r\nparty_DF.cache()\r\nval records = party_DF.join(NY_Senator_DF, col(\"party_detailed\") === col(\"Party\"))\r\nrecords.createOrReplaceTempView(\"records2\")","user":"anonymous","dateUpdated":"2021-11-23T22:30:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nUS_Senators_DF: org.apache.spark.sql.DataFrame = [year: string, state: string ... 17 more fields]\nNY_Senator_DF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [year: string, state: string ... 17 more fields]\nparty: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[2607] at parallelize at <console>:327\nparty_DF: org.apache.spark.sql.DataFrame = [Party: string]\nres245: party_DF.type = [Party: string]\nrecords: org.apache.spark.sql.DataFrame = [Party: string, year: string ... 18 more fields]\n"}]},"apps":[],"jobName":"paragraph_1637699476040_-1179621462","id":"20211123-203116_1117877927","dateCreated":"2021-11-23T20:31:16+0000","dateStarted":"2021-11-23T22:30:08+0000","dateFinished":"2021-11-23T22:30:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298"},{"text":"%spark.sql\nSELECT SUM(candidatevotes), Party FROM records2 GROUP BY Party ORDER BY SUM(candidatevotes) DESC","user":"anonymous","dateUpdated":"2021-11-23T23:41:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sum(CAST(candidatevotes AS DOUBLE))":"string","Party":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"pieChart":{},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Party","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(CAST(candidatevotes AS DOUBLE))","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sum(CAST(candidatevotes AS DOUBLE))\tParty\n4.8318995E7\tREPUBLICAN\n3.8660127E7\tDEMOCRAT\n1206600.0\tLIBERTARIAN\n320378.0\tGREEN\n24567.0\tSOCIALIST WORKERS\n19469.0\tNATURAL LAW\n"}]},"apps":[],"jobName":"paragraph_1637706488264_588526922","id":"20211123-222808_1857407045","dateCreated":"2021-11-23T22:28:08+0000","dateStarted":"2021-11-23T22:30:47+0000","dateFinished":"2021-11-23T22:30:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299"},{"text":"%spark.sql\n","user":"anonymous","dateUpdated":"2021-11-23T22:28:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637706524364_1728544713","id":"20211123-222844_578936234","dateCreated":"2021-11-23T22:28:44+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:300"}],"name":"Project2T5","id":"2GMVZ3JHH","angularObjects":{},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}