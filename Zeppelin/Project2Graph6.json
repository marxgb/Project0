{"paragraphs":[{"text":"%spark\r\nimport org.apache.spark.{SparkConf, SparkContext}\r\nimport org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql._\r\nimport org.apache.spark.sql.types.{StructType, StructField, StringType}\r\n\r\n\r\nval schemaString = \"year state state_po state_flips state_cen state_ic office candidate party_detailed writein candidates_votes total_votes version notes party_simplified\"\r\nval patient1 = sc.textFile(\"/data/Project1Data_SampleData.csv\")\r\nval schema = StructType(schemaString.split(\" \").map(fieldName => StructField(fieldName, StringType,true)))\r\nval rowRDD= patient1.map(_.split(\",\")).map(p=> Row(p(0), p(1), p(2), p(3), p(4),p(5),p(6),p(7),p(8),p(9),p(10),p(11),p(12),p(13),p(14)))\r\nval candidatesDF = sqlContext.createDataFrame(rowRDD, schema)\r\ncandidatesDF.createOrReplaceTempView(\"candidates\")","user":"anonymous","dateUpdated":"2021-12-02T21:25:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types.{StructType, StructField, StringType}\nschemaString: String = year state state_po state_flips state_cen state_ic office candidate party_detailed writein candidates_votes total_votes version notes party_simplified\npatient1: org.apache.spark.rdd.RDD[String] = /data/Project1Data_SampleData.csv MapPartitionsRDD[9] at textFile at <console>:44\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(year,StringType,true), StructField(state,StringType,true), StructField(state_po,StringType,true), StructField(state_flips,StringType,true), StructField(state_cen,StringType,true), StructField(state_ic,StringType,true), StructField(office,StringType,true), StructField(candidate,StringType,true), StructField(party_detailed,StringType,true), StructField(writein,StringType,true), StructField(candidates_votes,StringType,true), StructField(total_votes,StringType,true), StructField(version,StringType,true), StructField(notes,StringType,true), StructField(party_simplified,StringType,true))\nrowRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[11] at map at <console>:46\ncandidatesDF: org.apache.spark.sql.DataFrame = [year: string, state: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1637637223055_1501222041","id":"20211123-031343_872846778","dateCreated":"2021-11-23T03:13:43+0000","dateStarted":"2021-12-02T21:25:09+0000","dateFinished":"2021-12-02T21:25:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:207"},{"text":"%spark.sql    \nSELECT party_detailed, COUNT(party_detailed) AS totalCount FROM candidates WHERE party_detailed<>\"DEMOCRAT\" AND party_detailed<>\"REPUBLICAN\" GROUP BY party_detailed ORDER BY totalCount DESC LIMIT 15\n","user":"anonymous","dateUpdated":"2021-11-23T19:19:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"party_detailed":"string","totalCount":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"party_detailed","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"totalCount","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"party_detailed\ttotalCount\nLIBERTARIAN\t535\n\t456\nINDEPENDENT\t405\nGREEN\t211\nSOCIALIST WORKERS\t151\nCONSTITUTION PARTY\t148\nNATURAL LAW\t93\nREFORM PARTY\t90\nCOMMUNIST PARTY USE\t64\nNEW ALLIANCE\t62\nCITIZENS\t49\nALLIANCE\t45\nWORKERS WORLD\t44\nSOCIALIST\t41\nAMERICAN\t36\n"}]},"apps":[],"jobName":"paragraph_1637637228075_1053587842","id":"20211123-031348_1702945085","dateCreated":"2021-11-23T03:13:48+0000","dateStarted":"2021-11-23T19:19:07+0000","dateFinished":"2021-11-23T19:19:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208"},{"text":"%spark.sql    \nSELECT party_detailed, COUNT(party_detailed) AS totalCount FROM candidates GROUP BY party_detailed ORDER BY totalCount DESC LIMIT 15","user":"anonymous","dateUpdated":"2021-11-24T01:20:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"party_detailed":"string","totalCount":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"party_detailed\ttotalCount\nREPUBLICAN\t613\nDEMOCRAT\t612\nLIBERTARIAN\t535\n\t456\nINDEPENDENT\t405\nGREEN\t211\nSOCIALIST WORKERS\t151\nCONSTITUTION PARTY\t148\nNATURAL LAW\t93\nREFORM PARTY\t90\nCOMMUNIST PARTY USE\t64\nNEW ALLIANCE\t62\nCITIZENS\t49\nALLIANCE\t45\nWORKERS WORLD\t44\n"}]},"apps":[],"jobName":"paragraph_1637637252452_1386764401","id":"20211123-031412_1518243507","dateCreated":"2021-11-23T03:14:12+0000","dateStarted":"2021-11-24T01:20:25+0000","dateFinished":"2021-11-24T01:20:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"text":"%spark.sql\n","user":"anonymous","dateUpdated":"2021-11-24T01:20:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637716825602_696628934","id":"20211124-012025_330488211","dateCreated":"2021-11-24T01:20:25+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:210"}],"name":"Project2T1","id":"2GN64MKZP","angularObjects":{},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}